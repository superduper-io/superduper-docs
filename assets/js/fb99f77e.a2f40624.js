"use strict";(self.webpackChunknewdocs=self.webpackChunknewdocs||[]).push([[2968],{3483:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>l,contentTitle:()=>i,default:()=>o,frontMatter:()=>d,metadata:()=>c,toc:()=>h});var s=t(4848),n=t(8453);const d={},i=void 0,c={id:"api/base/query",title:"query",description:"superduper.base.query",source:"@site/docs/api/base/query.md",sourceDirName:"api/base",slug:"/api/base/query",permalink:"/docs/next/api/base/query",draft:!1,unlisted:!1,editUrl:"https://github.com/superduper-io/superduper/edit/main/docs/docs/api/base/query.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"metadata",permalink:"/docs/next/api/base/metadata"},next:{title:"schema",permalink:"/docs/next/api/base/schema"}},l={},h=[{value:"<code>bind</code>",id:"bind",level:2},{value:"<code>parse_query</code>",id:"parse_query",level:2},{value:"<code>route_db</code>",id:"route_db",level:2},{value:"<code>Query</code>",id:"query",level:2},{value:"<code>Decomposition</code>",id:"decomposition",level:2},{value:"<code>Op</code>",id:"op",level:2},{value:"<code>QueryPart</code>",id:"querypart",level:2}];function a(e){const r={a:"a",code:"code",h2:"h2",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,n.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:(0,s.jsx)(r.code,{children:"superduper.base.query"})})}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.a,{href:"https://github.com/superduper-io/superduper/blob/main/superduper/base/query.py",children:"Source code"})}),"\n",(0,s.jsx)(r.h2,{id:"bind",children:(0,s.jsx)(r.code,{children:"bind"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-python",children:"bind(f)\n"})}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"Parameter"}),(0,s.jsx)(r.th,{children:"Description"})]})}),(0,s.jsx)(r.tbody,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"f"}),(0,s.jsx)(r.td,{children:"The method to bind."})]})})]}),"\n",(0,s.jsx)(r.p,{children:"Bind a method to a query object."}),"\n",(0,s.jsx)(r.h2,{id:"parse_query",children:(0,s.jsx)(r.code,{children:"parse_query"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-python",children:"parse_query(query: Union[str,\n     list],\n     documents: Sequence[Any] = (),\n     db: Optional[ForwardRef('Datalayer')] = None)\n"})}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"Parameter"}),(0,s.jsx)(r.th,{children:"Description"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"query"}),(0,s.jsx)(r.td,{children:"The query to parse."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"documents"}),(0,s.jsx)(r.td,{children:"The documents to query."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"db"}),(0,s.jsx)(r.td,{children:"The datalayer to use to execute the query."})]})]})]}),"\n",(0,s.jsx)(r.p,{children:"Parse a string query into a query object."}),"\n",(0,s.jsx)(r.h2,{id:"route_db",children:(0,s.jsx)(r.code,{children:"route_db"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-python",children:"route_db(db: 'Datalayer',\n     table) -> 'Datalayer'\n"})}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"Parameter"}),(0,s.jsx)(r.th,{children:"Description"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"db"}),(0,s.jsx)(r.td,{children:"The datalayer to use."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"table"}),(0,s.jsx)(r.td,{children:"The table to use."})]})]})]}),"\n",(0,s.jsx)(r.p,{children:"Route the database to the correct datalayer."}),"\n",(0,s.jsx)(r.h2,{id:"query",children:(0,s.jsx)(r.code,{children:"Query"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-python",children:"Query(self,\n     *,\n     parts: Sequence[Union[superduper.base.query.QueryPart,\n     str]] = <factory>,\n     table: str,\n     db: dataclasses.InitVar[typing.Optional[ForwardRef('Datalayer')]] = None) -> None\n"})}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"Parameter"}),(0,s.jsx)(r.th,{children:"Description"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"table"}),(0,s.jsx)(r.td,{children:"The table to use."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"parts"}),(0,s.jsx)(r.td,{children:"The parts of the query."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"db"}),(0,s.jsxs)(r.td,{children:["The ",(0,s.jsx)(r.code,{children:"Datalayer"})," instance to use."]})]})]})]}),"\n",(0,s.jsx)(r.p,{children:"A query object."}),"\n",(0,s.jsx)(r.p,{children:"This base class is used to create a query object that can be executed\nin the datalayer."}),"\n",(0,s.jsx)(r.h2,{id:"decomposition",children:(0,s.jsx)(r.code,{children:"Decomposition"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-python",children:"Decomposition(self,\n     table: str,\n     db: 'Datalayer',\n     col: str | None = None,\n     insert: superduper.base.query.QueryPart | None = None,\n     pre_like: superduper.base.query.QueryPart | None = None,\n     post_like: superduper.base.query.QueryPart | None = None,\n     filter: superduper.base.query.QueryPart | None = None,\n     select: superduper.base.query.QueryPart | None = None,\n     get: superduper.base.query.QueryPart | None = None,\n     limit: superduper.base.query.QueryPart | None = None,\n     outputs: superduper.base.query.QueryPart | None = None,\n     op: superduper.base.query.Op | None = None) -> None\n"})}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"Parameter"}),(0,s.jsx)(r.th,{children:"Description"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"table"}),(0,s.jsx)(r.td,{children:"The table to use."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"db"}),(0,s.jsx)(r.td,{children:"The datalayer to use."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"col"}),(0,s.jsx)(r.td,{children:"The column to use."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"insert"}),(0,s.jsx)(r.td,{children:"The insert part of the query."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"pre_like"}),(0,s.jsx)(r.td,{children:"The pre-like part of the query."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"post_like"}),(0,s.jsx)(r.td,{children:"The post-like part of the query."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"filter"}),(0,s.jsx)(r.td,{children:"The filter part of the query."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"select"}),(0,s.jsx)(r.td,{children:"The select part of the query."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"get"}),(0,s.jsx)(r.td,{children:"The get part of the query."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"limit"}),(0,s.jsx)(r.td,{children:"The limit part of the query."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"outputs"}),(0,s.jsx)(r.td,{children:"The outputs part of the query."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"op"}),(0,s.jsx)(r.td,{children:"The operation part of the query."})]})]})]}),"\n",(0,s.jsx)(r.p,{children:"Decompose a query into its parts."}),"\n",(0,s.jsx)(r.h2,{id:"op",children:(0,s.jsx)(r.code,{children:"Op"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-python",children:"Op(self,\n     name: str,\n     args: Sequence,\n     kwargs: Dict,\n     symbol: str) -> None\n"})}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"Parameter"}),(0,s.jsx)(r.th,{children:"Description"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"name"}),(0,s.jsx)(r.td,{children:"The name of the method."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"args"}),(0,s.jsx)(r.td,{children:"The arguments of the method."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"kwargs"}),(0,s.jsx)(r.td,{children:"The keyword arguments of the method."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"symbol"}),(0,s.jsx)(r.td,{children:"The symbol of the operation."})]})]})]}),"\n",(0,s.jsx)(r.p,{children:"An operation part of a query."}),"\n",(0,s.jsx)(r.h2,{id:"querypart",children:(0,s.jsx)(r.code,{children:"QueryPart"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-python",children:"QueryPart(self,\n     name: str,\n     args: Sequence,\n     kwargs: Dict) -> None\n"})}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"Parameter"}),(0,s.jsx)(r.th,{children:"Description"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"name"}),(0,s.jsx)(r.td,{children:"The name of the method."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"args"}),(0,s.jsx)(r.td,{children:"The arguments of the method."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"kwargs"}),(0,s.jsx)(r.td,{children:"The keyword arguments of the method."})]})]})]}),"\n",(0,s.jsx)(r.p,{children:"A method part of a query."})]})}function o(e={}){const{wrapper:r}={...(0,n.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},8453:(e,r,t)=>{t.d(r,{R:()=>i,x:()=>c});var s=t(6540);const n={},d=s.createContext(n);function i(e){const r=s.useContext(d);return s.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function c(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:i(e.components),s.createElement(d.Provider,{value:r},e.children)}}}]);